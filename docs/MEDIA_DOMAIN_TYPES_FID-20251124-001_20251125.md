# Media Domain Types & Interfaces

**FID:** FID-20251124-001  
**Date:** 2025-11-25  
**Purpose:** Define consolidated TypeScript interfaces for all media domain entities, ensuring type safety, DRY compliance, and utility-first architecture alignment.

---

## Core Domain Entities

### Platform

```typescript
/**
 * Media distribution platform (YouTube, Instagram, TikTok, etc.)
 */
interface Platform {
  _id: string;
  company: string; // Reference to Company
  ownedBy: string; // User ID
  platformType: PlatformType;
  platformName: string;
  isActive: boolean;
  
  // Configuration
  config: {
    platformUrl: string;
    apiConnected: boolean;
    autoPublish: boolean;
    contentTypes: string[];
    customSettings: Record<string, any>;
  };
  
  // Metrics
  metrics: {
    totalFollowers: number;
    monthlyReach: number;
    engagementRate: number;
    avgCPM: number;
    totalRevenue: number;
    monthlyRevenue: number;
    totalImpressions?: number;
  };
  
  // Algorithm optimization
  algorithmOptimization: {
    algorithmScore: number;
    preferredContentLength: number;
    preferredPostingTimes: string[];
    hashtagStrategy: string[];
    trendingTopics: string[];
    contentFormatPreferences: Record<string, number>;
  };
  
  // Content distribution
  contentDistribution: {
    publishedContent: number;
    scheduledContent: number;
    contentPerformanceAvg: number;
    bestPerformingContent: string[]; // Content IDs
  };
  
  // Monetization
  monetization: {
    monetizationEnabled: boolean;
    monetizationTier: MonetizationTier;
    revenueShare: number;
    adFormats: string[];
    sponsorshipOpportunities: number;
    brandDeals: number;
    efficiency?: number;
  };
  
  // Audit fields
  createdAt: Date;
  updatedAt: Date;
}

type PlatformType = 'YouTube' | 'Instagram' | 'TikTok' | 'Twitter' | 'Facebook' | 'LinkedIn' | 'Podcast' | 'Blog';
type MonetizationTier = 'None' | 'Partner' | 'Premium' | 'Elite';
```

### MediaContent

```typescript
/**
 * Content piece distributed across platforms
 */
interface MediaContent {
  _id: string;
  ownedBy: string; // Company ID
  title: string;
  type: ContentType;
  description: string;
  platforms: string[]; // Platform IDs
  targetAudience: string[]; // Audience segment IDs
  status: ContentStatus;
  
  // Scheduling
  scheduledDate?: Date;
  publishedDate?: Date;
  
  // Content properties
  duration: number; // Seconds
  tags: string[];
  thumbnail: string;
  
  // Production
  productionCost: number;
  targetEngagement: number;
  contentStrategy: Record<string, any>;
  
  // Engagement metrics
  engagementMetrics: {
    views: number;
    uniqueViewers: number;
    likes: number;
    shares: number;
    comments: number;
    saves: number;
    watchTime: number;
    totalInteractions: number;
    completionRate: number;
    rewatchRate?: number;
  };
  
  // Quality metrics
  qualityMetrics?: {
    productionQuality: number; // 1-10
    contentQuality: number; // 1-10
    relevanceScore: number; // 1-10
  };
  
  // Performance
  reach: number;
  monetization: {
    estimatedRevenue: number;
    actualRevenue: number;
    cpm: number;
    rpm: number;
  };
  
  // Analytics
  performanceHistory: PerformanceSnapshot[];
  abTestVariants: ABTestVariant[];
  
  // Audit fields
  createdAt: Date;
  updatedAt: Date;
}

type ContentType = 'video' | 'image' | 'article' | 'podcast' | 'livestream' | 'story' | 'reel' | 'short';
type ContentStatus = 'Draft' | 'Scheduled' | 'Published' | 'Archived' | 'Deleted';
```

### PerformanceSnapshot

```typescript
/**
 * Point-in-time performance metrics for content
 */
interface PerformanceSnapshot {
  timestamp: Date;
  views: number;
  likes: number;
  shares: number;
  comments: number;
  watchTime: number;
  engagementRate: number;
  viralCoefficient: number;
  revenue: number;
  performanceScore: number;
}
```

### ABTestVariant

```typescript
/**
 * A/B test variant for content optimization
 */
interface ABTestVariant {
  variantId: string;
  name: string;
  thumbnail?: string;
  title?: string;
  description?: string;
  impressions: number;
  clicks: number;
  conversions: number;
  ctr: number;
  conversionRate: number;
  winner?: boolean;
}
```

### AudienceProfile

```typescript
/**
 * Audience segment with demographics and engagement
 */
interface AudienceProfile {
  _id: string;
  ownedBy: string; // Company ID
  platform: string; // Platform ID
  segment: string;
  size: number;
  previousSize?: number;
  
  // Demographics
  demographics: {
    age?: Record<string, number>; // Age group percentages
    gender?: Record<string, number>;
    income?: Record<string, number>;
    education?: Record<string, number>;
    location?: Record<string, number>;
  };
  
  // Interests & behaviors
  interests: string[];
  behaviors: string[];
  deviceTypes: string[];
  
  // Location
  location: {
    countries?: Record<string, number>;
    regions?: Record<string, number>;
    cities?: Record<string, number>;
  };
  
  // Economics
  acquisitionCost: number;
  lifetimeValue: number;
  
  // Engagement
  engagementMetrics?: {
    avgInteractionRate: number;
    avgSessionDuration: number;
    avgContentConsumption: number;
  };
  
  // Retention
  retentionMetrics?: {
    retentionRate: number;
    churnRate: number;
    lifetimeValuePerFollower: number;
    avgFollowerLifetime: number;
  };
  
  // History
  growthHistory: GrowthDataPoint[];
  engagementHistory: EngagementDataPoint[];
  
  // Audit fields
  createdAt: Date;
  updatedAt: Date;
}
```

### GrowthDataPoint

```typescript
/**
 * Historical growth data point
 */
interface GrowthDataPoint {
  date: Date;
  size: number;
  newFollowers: number;
  lostFollowers: number;
  growthRate: number;
}
```

### EngagementDataPoint

```typescript
/**
 * Historical engagement data point
 */
interface EngagementDataPoint {
  date: Date;
  interactions: number;
  engagementRate: number;
  activeUsers: number;
}
```

### MonetizationConfig

```typescript
/**
 * Monetization settings and revenue optimization
 */
interface MonetizationConfig {
  _id: string;
  company: string; // Company ID
  isActive: boolean;
  
  // Strategy
  strategy: MonetizationStrategy;
  defaultCPM: number;
  
  // CPM optimization
  cpmByAge?: Record<string, number>; // Multipliers by age group
  cpmByIncome?: Record<string, number>; // Multipliers by income
  cpmByLocation?: Record<string, number>; // Multipliers by location
  cpmByDevice?: Record<string, number>; // Multipliers by device type
  
  // Subscription tiers
  subscriptionTiers: SubscriptionTier[];
  
  // Affiliate settings
  affiliateEnabled: boolean;
  affiliateCommissionRate: number;
  affiliateCategories: Record<string, number>; // Category → commission %
  
  // Platform revenue sharing
  platformRevShares: Record<string, number>; // Platform → share %
  
  // Constraints
  minCPM: number;
  maxCPM: number;
  
  // Targeting
  targetDemographics: string[];
  excludedAdvertisers: string[];
  preferredAdvertisers: string[];
  
  // Metrics
  totalSubscribers: number;
  totalMRR: number; // Monthly Recurring Revenue
  totalARR: number; // Annual Recurring Revenue
  avgRevenuePerUser: number;
  churnRate: number;
  subscriptionRevenue?: number;
  isProfitable?: boolean;
  
  // Audit fields
  createdAt: Date;
  updatedAt: Date;
}

type MonetizationStrategy = 'AdRevenue' | 'Subscription' | 'Affiliate' | 'Hybrid';
```

### SubscriptionTier

```typescript
/**
 * Subscription tier with pricing and benefits
 */
interface SubscriptionTier {
  name: string;
  price: number;
  billingPeriod: 'monthly' | 'quarterly' | 'annual';
  benefits: string[];
  subscriberCount: number;
  churnRate: number;
}
```

### AdCampaign

```typescript
/**
 * Advertising campaign with performance tracking
 */
interface AdCampaign {
  _id: string;
  platform: string; // Platform ID
  advertiser: string; // Company ID
  name: string;
  type: AdCampaignType;
  status: CampaignStatus;
  
  // Timing
  startDate: Date;
  endDate?: Date;
  
  // Targeting
  targetedContent: string[]; // Content IDs
  targetedInfluencers: string[]; // Influencer IDs
  targetedAudience: string[]; // Audience IDs
  audienceType: AudienceType;
  
  // Bidding
  biddingModel: BiddingModel;
  bidAmount: number;
  dailyBudget: number;
  totalBudget: number;
  
  // Goals
  goals: {
    impressions?: number;
    clicks?: number;
    conversions?: number;
    targetROAS?: number;
  };
  
  // Performance metrics
  metrics: {
    impressions: number;
    clicks: number;
    conversions: number;
    engagements?: number;
    spend: number;
    revenue: number;
  };
  
  // Quality scores
  qualityScore: number; // 1-10
  relevanceScore: number; // 0-100
  engagementScore: number; // 0-100
  
  // Audit fields
  createdAt: Date;
  updatedAt: Date;
}

type AdCampaignType = 'Display' | 'Video' | 'Search' | 'Social' | 'Influencer' | 'Sponsored';
type CampaignStatus = 'Active' | 'Paused' | 'Completed' | 'Cancelled';
type AudienceType = 'Broad' | 'Targeted' | 'Lookalike' | 'Retargeting';
type BiddingModel = 'CPC' | 'CPM' | 'CPE' | 'CPA';
```

### InfluencerDeal

```typescript
/**
 * Influencer marketing contract
 */
interface InfluencerDeal {
  _id: string;
  company: string; // Company ID
  influencer: string; // User ID or external influencer ID
  dealType: DealType;
  status: DealStatus;
  
  // Compensation
  compensation: number;
  paymentStructure: PaymentStructure;
  basePayment: number;
  bonusThresholds: BonusThreshold[];
  paymentSchedule: PaymentSchedule;
  paidToDate: number;
  
  // Content requirements
  requiredContent: number;
  contentTypes: string[];
  deliveredContent: string[]; // Content IDs
  deliveryDeadlines: Date[];
  
  // Contract terms
  exclusivityClause: boolean;
  exclusivityPeriod?: number; // Days
  contentApprovalRequired: boolean;
  usageRights: UsageRights;
  terminationClause: string;
  penaltyForNonDelivery: number;
  
  // Influencer metrics
  influencerFollowers: number;
  influencerEngagementRate: number;
  influencerNiche: string;
  influencerReach: number;
  influencerDemographics: Record<string, any>;
  
  // Performance
  totalImpressions: number;
  totalEngagement: number;
  totalConversions: number;
  conversionRate: number;
  actualROI: number;
  projectedROI: number;
  deliveryProgress?: number;
  averageEngagementRate?: number;
  costPerImpression?: number;
  costPerEngagement?: number;
  
  // Timing
  startDate: Date;
  endDate: Date;
  autoRenew: boolean;
  
  // Audit fields
  createdAt: Date;
  updatedAt: Date;
}

type DealType = 'Sponsored' | 'Ambassador' | 'Affiliate' | 'PerformanceBased';
type DealStatus = 'Pending' | 'Active' | 'Completed' | 'Cancelled' | 'Breached';
type PaymentStructure = 'Flat' | 'PerPost' | 'PerformanceBased' | 'Tiered' | 'Hybrid';
type PaymentSchedule = 'Upfront' | 'OnCompletion' | 'Monthly' | 'PerDeliverable';
type UsageRights = 'Limited' | 'Perpetual' | 'Exclusive' | 'NonExclusive';
```

### BonusThreshold

```typescript
/**
 * Performance-based bonus threshold
 */
interface BonusThreshold {
  metric: 'impressions' | 'engagement' | 'conversions' | 'revenue';
  threshold: number;
  bonusAmount: number;
  achieved: boolean;
}
```

### SponsorshipContract

```typescript
/**
 * Brand sponsorship deal
 */
interface SponsorshipContract {
  _id: string;
  sponsor: string; // Company ID (sponsor)
  recipient: string; // Company ID (media company)
  dealValue: number;
  dealStructure: DealStructure;
  duration: number; // Months
  status: DealStatus;
  
  // Timing
  startDate: Date;
  endDate: Date;
  
  // Payment structure
  upfrontPayment: number;
  monthlyPayment: number;
  revenueSharePercent: number;
  performanceBonuses: BonusThreshold[];
  totalPaid: number;
  remainingPayments: number;
  
  // Content requirements
  requiredMentions: number;
  contentRequirements: string[];
  deliveredContent: string[]; // Content IDs
  approvalRequired: boolean;
  brandGuidelines: string;
  
  // Exclusivity
  exclusivityClause: boolean;
  competitorCategories: string[];
  exclusivityDuration: number; // Months
  penaltyForViolation: number;
  
  // Performance metrics
  totalImpressions: number;
  totalEngagement: number;
  brandMentions: number;
  brandSentiment: number; // -100 to 100
  brandLift: number; // Percentage
  estimatedReach: number;
  actualReach: number;
  
  // Fulfillment
  milestonesAchieved: number;
  totalMilestones: number;
  overdueDeliverables: number;
  completionRate: number;
  fulfillmentProgress?: number;
  averageBonusAchieved?: number;
  totalEarnedBonuses?: number;
  
  // Legal
  contractTerms: string;
  terminationClause: string;
  disputeResolution: string;
  intellectualProperty: string;
  usageRights: string;
  
  // Audit fields
  createdAt: Date;
  updatedAt: Date;
}

type DealStructure = 'Flat' | 'Tiered' | 'PerformanceBased' | 'RevenueShare' | 'Hybrid';
```

---

## Utility Function Input/Output Types

### Metrics Calculation Types

```typescript
/**
 * Content metrics for engagement calculations
 */
interface ContentMetrics {
  views: number;
  likes: number;
  shares: number;
  comments: number;
  watchTime: number;
  uniqueViewers?: number;
  completionRate?: number;
  rewatchRate?: number;
  saves?: number;
}

/**
 * Audience retention metrics
 */
interface RetentionMetrics {
  retainedFollowers: number;
  startingFollowers: number;
  lostFollowers: number;
  newFollowers: number;
}

/**
 * Growth projection parameters
 */
interface GrowthProjection {
  currentFollowers: number;
  growthRate: number;
  projectionMonths: number;
  confidenceInterval?: number;
}

/**
 * Monetization potential calculation inputs
 */
interface MonetizationInputs {
  views: number;
  uniqueViewers: number;
  shares: number;
  comments: number;
  likes: number;
  watchTime: number;
  completionRate: number;
  cpm: number;
  platformMultiplier: number;
}

/**
 * ROI calculation inputs
 */
interface ROIInputs {
  revenue: number;
  cost: number;
  spend?: number;
}

/**
 * Virality calculation inputs
 */
interface ViralityInputs {
  shares: number;
  views: number;
  uniqueShares?: number;
  viralLoopCycles?: number;
}
```

---

## Error Response Types

```typescript
/**
 * Standardized error response
 */
interface ErrorResponse {
  error: string;
  code?: string;
  details?: Record<string, any>;
}

/**
 * Validation error details
 */
interface ValidationError {
  field: string;
  message: string;
  value?: any;
}
```

---

## Pagination & Filtering Types

```typescript
/**
 * Standard pagination metadata
 */
interface PaginationMeta {
  total: number;
  limit: number;
  offset: number;
  hasMore: boolean;
}

/**
 * Generic paginated response
 */
interface PaginatedResponse<T> {
  data: T[];
  pagination: PaginationMeta;
}

/**
 * Common query parameters
 */
interface QueryParams {
  limit?: number;
  offset?: number;
  sortBy?: string;
  sortOrder?: 'asc' | 'desc';
  [key: string]: any; // Additional filters
}
```

---

## Implementation Notes

### Type Safety Guidelines

1. **Strict null checks**: All optional fields marked with `?`
2. **Discriminated unions**: Use type literals for status/type fields
3. **No `any` types**: Use `Record<string, unknown>` or define proper types
4. **Readonly where appropriate**: Add `readonly` for immutable fields
5. **Generic types**: Use generics for reusable patterns (e.g., `PaginatedResponse<T>`)

### DRY Enforcement

1. **Shared base types**: Extract common patterns (timestamps, IDs)
2. **Composition over duplication**: Compose complex types from primitives
3. **Type aliases**: Use for repeated patterns
4. **Utility types**: Leverage TypeScript utility types (`Pick`, `Omit`, `Partial`)

### Integration with Mongoose Models

- These interfaces represent the **logical domain model**
- Mongoose schemas will implement these interfaces
- Add `toObject()` return type annotations for API responses
- Use type guards for runtime validation

### Next Steps

1. Implement these types in `src/lib/types/media.ts`
2. Update Mongoose models to implement interfaces
3. Create Zod schemas for runtime validation
4. Update API routes to use typed responses
5. Generate OpenAPI/Swagger documentation from types

---

**Footer:** Generated under ECHO v1.3.0 (GUARDIAN active). All types follow strict TypeScript, DRY, and utility-first principles. Ready for implementation phase.
