# FID-20251125-001A – Political System Foundation (Phase 1 Core Framework)

**Status:** PLANNED  
**Priority:** HIGH  
**Complexity:** 4/5  
**Created:** 2025-11-25  
**Estimated:** 95–130h (3–4 weeks elapsed time with parallel minor tasks)

## 1. Summary
Implements the deterministic, utility‑first backbone for the Political System on top of the unified 168× accelerated game time model. Establishes conversion/scheduling utilities, derived state metrics, baseline influence & lobbying probability scaffolds, offline protection/autopilot primitives, and strongly typed domain interfaces. Provides a clean, DRY, reusable substrate that Phase 2 (engagement engines) composes without duplication or retrofits.

## 2. Problem / Motivation
Advanced campaign, polling, endorsement, crisis, and dynamic difficulty mechanics cannot be safely implemented until:
- Time math is centralized (no ad‑hoc conversions)  
- Derived metrics (population/gdp/seat/crime weighting) exist with normalization rules  
- Influence/lobbying baseline formulas are stable + documented  
- Offline fairness + autopilot clamps prevent negative drift for absent players  
- Strong interfaces allow feature expansion without structural rewrites  
- Legacy parity for political seeds & state data is codified (ZERO omissions)  

## 3. Acceptance Criteria
- timeScaling utility: real→game & game→real, week/hour/min conversions, senate class cycle helper, nextElection calculators.  
- stateDerivedMetrics utility: populationShare, gdpShare, seatShare, crimePercentile, compositeInfluenceWeight with documented normalization + edge handling.  
- influenceBase & lobbyingBase utilities: deterministic probability + scaling skeleton (logistic or capped log curve), zero side effects, pure functions.  
- offlineProtection primitives: clampDecay, gracePeriod schedule, autopilotStrategy presets ("balanced", "growth", "defensive"), captureOfflineSnapshot & applyCatchUp delta logic.  
- Domain types/interfaces: Campaign, CampaignPhase, ElectionCycle, PoliticalOffice, InfluenceRecord, LobbyingAction, LegislationSkeleton, EndorsementStub, CrisisEventStub, AutopilotProfile, OfflineSnapshot.  
- TIME_SYSTEM.md & POLITICS_SCALING.md created (docs/) with formulas, rationale, sample scenarios.  
- 100% legacy parity checklist for political seeds (states, seat allocations, senate classes, house apportionment).  
- All utilities pure, side‑effect free, unit tested (≥90% branch coverage on utilities).  
- AAA quality: JSDoc for each exported function, no duplicate logic, no placeholder TODO code.  
- TypeScript strict mode: 0 new errors introduced.  

## 4. Scope (Included)
- Core utilities + types only (no polling engine, no debate scheduler).  
- Baseline probability formulas (no advanced event modifiers).  
- Offline snapshot/autopilot scaffolding (without UI integration).  
- Documentation + tests.  

## 5. Out of Scope (Deferred to Phase 2 / FID-20251125-001B)
- Campaign phase machine transitions & persistence hooks.  
- Real-time polling, ad spend cadence, debates, election night counting loops.  
- Scandals, crises escalators, endorsement full logic, achievement triggers.  
- Dynamic difficulty scaling & leaderboard broadcast infrastructure.  

## 6. Approach
1. Utility-first ordering: Types → pure math/conversion → derived metrics → baseline influence/lobbying → offline protection.  
2. Ensure DRY via one source modules; cross-utility composition (e.g., lobbyingBase uses compositeInfluenceWeight).  
3. Document each formula before implementation (POLITICS_SCALING.md first draft).  
4. Add focused unit tests per utility module immediately after creation.  
5. Generate docs (TIME_SYSTEM.md, POLITICS_SCALING.md) upon stabilization; link from completion report.  
6. Parity checklist verified against legacy seed & government files; store in docs or dev parity matrix.  
7. Guard rails: no random logic, all deterministic with seedless pure functions for baseline layer.  

## 7. Detailed Tasks (Utility-First Phases)
- Phase A: Define `politicsTypes.ts` interfaces + enums.  
- Phase B: Implement `timeScaling.ts`.  
- Phase C: Implement `stateDerivedMetrics.ts`.  
- Phase D: Implement `influenceBase.ts`.  
- Phase E: Implement `lobbyingBase.ts`.  
- Phase F: Implement `offlineProtection.ts`.  
- Phase G: Write docs (TIME_SYSTEM.md, POLITICS_SCALING.md).  
- Phase H: Unit tests & coverage validation.  
- Phase I: Parity checklist finalization & verification log.  

## 8. File Plan
NEW: `src/politics/types/politicsTypes.ts`  
NEW: `src/politics/utils/timeScaling.ts`  
NEW: `src/politics/utils/stateDerivedMetrics.ts`  
NEW: `src/politics/utils/influenceBase.ts`  
NEW: `src/politics/utils/lobbyingBase.ts`  
NEW: `src/politics/utils/offlineProtection.ts`  
NEW: `docs/TIME_SYSTEM.md`  
NEW: `docs/POLITICS_SCALING.md`  
TEST: `tests/politics/timeScaling.test.ts`, `tests/politics/derivedMetrics.test.ts`, `tests/politics/influenceBase.test.ts`, `tests/politics/offlineProtection.test.ts`  

## 9. Dependencies
- Legacy state & seat data (already extracted).  
- Logger & currency utilities (existing).  
- No external network dependencies.  

## 10. Risks & Mitigation
| Risk | Impact | Mitigation |
|------|--------|-----------|
| Formula creep before docs | Inconsistent scaling | Lock formulas after doc review (Phase G) |
| Hidden legacy parity gap | Player trust loss | Exhaustive parity checklist & diff verification |
| Coupling utilities early | Refactor churn | Enforce purity & separated modules |
| Offline clamp unfairness | Player churn | Simulate scenarios in tests before lock |

## 11. Legacy Parity Checklist (Political Seeds)
- [ ] State list (names, abbreviations)  
- [ ] Population figures (normalized)  
- [ ] GDP figures  
- [ ] House seat apportionment per state  
- [ ] Senate classes mapping (I/II/III)  
- [ ] Crime metric reference values  
- [ ] Validation of compositeInfluenceWeight vs legacy influence patterns  

## 12. Metrics / Success
- 0 TypeScript errors introduced.  
- ≥90% test coverage utilities.  
- Docs published & referenced by Phase 2 PRD.  
- One-call conversions (no duplicate time math across codebase).  
- Influence weight variance stable (<5% dispersion after normalization test suite).  

## 13. Completion Report Hook
On completion: generate `COMPLETION_REPORT_FID-20251125-001A_<date>.md`, reference parity checklist status, include formula proofs & test coverage summary.

## 14. Exit Criteria
All acceptance items met; parity checklist 100% checked; docs finalized; tests green; baseline formulas stable.

---
*ECHO v1.3.0 – GUARDIAN protocol enforced; utility-first, DRY, zero duplication.*
