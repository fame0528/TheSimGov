# FID-20251125-001B – Political System Engagement & Dynamic Mechanics (Phase 2)

**Status:** PLANNED  
**Priority:** HIGH  
**Complexity:** 5/5  
**Created:** 2025-11-25  
**Estimated:** 210–300h (6–8 weeks elapsed time with staggered testing)

## 1. Summary
Build on Phase 1 foundation to deliver the addicting engagement layer: campaign phase machine, polling/ad/debate loops, election night progression, crises & scandals, endorsement and social influence systems, dynamic balance scaling (purely systemic, no AI opponents), achievements, live leaderboards, and player fairness under accelerated time. All mechanics compose exclusively from Phase 1 utilities (no duplication) and preserve deterministic & testable behavior. The game has ONLY real human players; there are zero NPC/AI player entities. All balancing adjusts shared systemic parameters (costs, caps, probability curves) derived from aggregate human player distributions.

## 2. Problem / Motivation
Static political data is insufficient for sustained engagement. Need real-time loops that create urgency, strategic risk, progression, and social comparison while respecting offline fairness constraints and unified time acceleration. Must avoid ad-hoc timing logic or probabilistic opacity.

## 3. Acceptance Criteria
- CampaignPhaseMachine: 26h real campaign (4×6.5h) with persisted state, restart rules, phase gating for actions.  
- Polling engine: interval (25m real) with weighted sampling, volatility dampening for offline players, historical trend series.  
- Ad spend cycle: 8.5m real cadence influencing short-term polling deltas; diminishing returns model implemented.  
- Debate scheduler: phases at real hours 6 / 15 / 22 with participation validation, performance scoring, endorsement effects.  
- Election night counting: 3.5m segmented result reveal (batches), near-miss logic (recount triggers).  
- Endorsement system: request pipeline, cooldown (1 game-year), stacking caps, reciprocal network bonuses.  
- Crisis & scandal generator: tiered severities (minor/medium/major/annual), response windows, offline defer queue semantics.  
- Dynamic balance scaling: systemic modulation of resource efficiency caps, lobbying cost modifiers, scandal probability curves, and catch-up buffers based on aggregate player ranking distribution & active time bands (NO AI players).  
- Achievements engine: criteria registry, real-time unlock batching, login summary packaging.  
- Leaderboards: influence, campaign performance, legislative success; real-time broadcasting (Socket.io) with throttling.  
- Offline fairness: integration with autopilot snapshots (from Phase 1) ensuring no punitive divergence > defined clamp thresholds.  
- All features produce structured telemetry events (internal bus) for analytics.  
- 0 TypeScript errors; comprehensive tests (campaign machine, polling variance, achievement unlock logic).  
 - Backend–Frontend Dual-Loading Protocol executed before UI/API edits; Contract Matrix (Endpoint/Event → Method/Name → Request → Response → Status/Errors) generated and verified.  
 - Index files present for new folders to keep exports clean (`index.ts` in engines, systems, leaderboards, events).  

## 4. Scope (Included)
- Real-time engines & schedulers.  
- Interaction models (endorsements, debates, ads, crises).  
- Telemetry + leaderboard broadcast scaffolding.  
- Achievement criteria + notification dispatch.  

## 5. Out of Scope (Deferred)
- Advanced visualization components beyond core UI integration.  
- External analytics pipeline ingestion.  
- Cross-industry synergy bonuses (future phase).  

## 6. Approach
1. Sequence by dependency: Campaign machine → polling → ads → debates → election night → endorsements → crises/scandals → dynamic balance → achievements → leaderboards.  
2. Reuse baseline formulas (no redefinition).  
3. Maintain deterministic, reproducible scheduling and calculation paths (no simulated opponents; all competitors are human).  
4. Introduce internal event bus abstraction for decoupled telemetry & achievement triggering.  
5. Use composable handlers (e.g., `applyPollingDeltas`, `resolveDebateOutcome`).  
6. Layer offline adjustments through existing offlineProtection primitives (Phase 1).  
7. Strict DRY audits: any repeated calculation extracted upward.  
8. Execute Backend–Frontend Dual-Loading Protocol and produce a Contract Matrix for REST and WebSocket surfaces prior to integration.  

## 7. Detailed Tasks (Sequenced)
- Phase A: CampaignPhaseMachine implementation + persistence mapping.  
- Phase B: PollingEngine with weighting + volatility smoothing.  
- Phase C: AdSpendCycle & diminishing returns model.  
- Phase D: DebateScheduler + outcome scoring + endorsement hooks.  
- Phase E: ElectionNightProgress engine + recount logic.  
- Phase F: Endorsements system (requests, cooldown, stacking).  
- Phase G: CrisisScandalGenerator + defer queue + response handlers.  
- Phase H: DynamicBalanceScaler (systemic resource multipliers, scandal probability curve, catch-up modifiers for lower-activity bands).  
- Phase I: AchievementsEngine + criteria registry + summary builder.  
- Phase J: Leaderboards + Socket.io broadcast throttling.  
- Phase K: Telemetry & internal event bus abstraction.  
- Phase L: Comprehensive integration tests + load simulations.  

## 8. File Plan (Illustrative)
NEW: `src/politics/engines/campaignPhaseMachine.ts`  
NEW: `src/politics/engines/pollingEngine.ts`  
NEW: `src/politics/engines/adSpendCycle.ts`  
NEW: `src/politics/engines/debateScheduler.ts`  
NEW: `src/politics/engines/electionNightProgress.ts`  
NEW: `src/politics/systems/endorsements.ts`  
NEW: `src/politics/systems/crisisScandal.ts`  
NEW: `src/politics/systems/dynamicBalanceScaler.ts`  
NEW: `src/politics/systems/achievements.ts`  
NEW: `src/politics/leaderboards/leaderboards.ts`  
NEW: `src/politics/events/telemetryBus.ts`  
TEST: `tests/politics/campaignPhaseMachine.test.ts`, etc.  
DOCS: `docs/TELEMETRY_EVENTS.md`, `docs/ENGAGEMENT_ENGINE_SPEC.md`  
INDEX EXPORTS: `src/politics/engines/index.ts`, `src/politics/systems/index.ts`, `src/politics/leaderboards/index.ts`, `src/politics/events/index.ts`  

## 9. Dependencies
- Phase 1 utilities (timeScaling, derived metrics, influenceBase, lobbyingBase, offlineProtection).  
- Socket.io server (already in `server.js`).  
- Logger utility for telemetry.  

## 10. Risks & Mitigation
| Risk | Impact | Mitigation |
|------|--------|-----------|
| Scheduler drift vs 168× model | Desync events | Centralize all time calls via timeScaling |
| Polling volatility exploitation | Player manipulation | Apply capped delta & smoothing window |
| Offline disadvantage | Churn | Autopilot + clamp integration tests |
| Achievement spam | Notification overload | Batch & throttle dispatches |
| Balance skew for low-activity players | Frustration / churn | Transparent systemic scaling rules, catch-up buffers, simulation tests |

## 11. Engagement Design Principles
- Frequent micro-decisions (ads, polling adjustments).  
- Mid-phase strategic events (debates, endorsements).  
- Long-cycle tension (election nights, crises).  
- Persistent progression (achievements, leaderboards).  
- Fairness overlays (offline protective logic).  

## 12. Telemetry / Analytics Hooks
Event types: `POLLING_TICK`, `AD_SPEND_APPLIED`, `DEBATE_RESULT`, `ENDORSEMENT_GRANTED`, `CRISIS_TRIGGERED`, `ACHIEVEMENT_UNLOCKED`, `LEADERBOARD_UPDATE`. Each standardized payload includes timestamp gameWeek index, actor IDs, deltas, normalization factors, offline adjustment flags.

## 13. Metrics / Success
- Player session retention uplift (target +15% vs baseline).  
- Average campaign interaction frequency (≥12 meaningful actions / 26h cycle).  
- ≤5% polling volatility advantage for always-online players (fairness metric).  
- Achievement unlock recognition latency <2s real.  
- Leaderboard broadcast interval compliance (≤1 broadcast / 10s per category).  

## 14. Completion Report Hook
On completion generate `COMPLETION_REPORT_FID-20251125-001B_<date>.md` with engagement KPI baselines, fairness audit, systemic balance scaling validation (no AI), and telemetry event schema.

## 15. Exit Criteria
All listed engines implemented, tests (unit + integration + load) passing, telemetry events documented, fairness audits green, no duplication, 0 TypeScript errors.

---
*ECHO v1.3.0 – GUARDIAN protocol enforced; utility-first composition over duplication; deterministic scheduling.*
